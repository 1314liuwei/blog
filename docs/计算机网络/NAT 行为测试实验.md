# NAT 行为测试实验

> 实验目的：测试 NAT 的 Filtering Behavior 

## 实验一：S端向C端持续发包，测试C 端NAT Filtering Behavior持续时间

实验步骤：

1. S 端启动服务进程，等待接收 C 端发送来的数据。S端接收到C端数据后开始递增间隔（每次增加1s）向C端发送数据
2. C 端向 S 端发送数据，并等待接收响应，响应接收成功后停止向S端发送数据，转而向一个S1端定时发送数据(防止NAT Mapping Behavior过期)
3. 找出C端接收不到数据的时间间隔，进行下一步测试
4. C 端向 S 端发送数据，并等待接收响应，响应接收成功后停止向S端发送数据
5. S 端启动服务进程，等待接收 C 端发送来的数据。S端接收到C端数据后，以最大时间间隔（左右偏移五秒，依次递增）向C端发送数据，判断C端能否收到数据，如果不能收到数据，那么结束实验；如果能收到数据，进行下一步判断
6. S 端启动服务进程，等待接收 C 端发送来的数据。S端接收到C端数据后，以C端第一次收到数据的时间到最后一次收到数据的时间间隔（左右偏移十秒，依次递增）向C端发送数据，判断C端能否收到数据，如果不能收到数据，那么结束实验；

实验数据：

```bash
# 1. 测试1
# 第一次收到数据的时间
2023/04/21 15:24:01 recv from 116.62.229.23:22345 data: I'm Server
# 最后一次接收到数据的时间
2023/04/21 15:56:35 recv from 116.62.229.23:22345 data: I'm Server
2023/04/21 15:56:35 use time:  1m2.0594247s

# 第一次收到数据的时间
2023/04/21 16:01:06 recv from 116.62.229.23:22345 data: I'm Server
# 最后一次接收到数据的时间
2023/04/21 16:37:58 recv from 116.62.229.23:22345 data: I'm Server
2023/04/21 16:37:58 use time:  1m6.0623072s

# 第一次收到数据的时间
2023/04/21 16:44:57 recv from 116.62.229.23:22345 data: I'm Server
# 最后一次接收到数据的时间
2023/04/21 17:03:39 recv from 116.62.229.23:22345 data: I'm Server
2023/04/21 17:03:39 use time:  1m8.062157s

# 第一次收到数据的时间
2023/04/21 17:08:48 start send data to 116.62.229.23:22346
```

